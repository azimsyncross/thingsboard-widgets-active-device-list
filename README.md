### ThingsBoard Widget - Active Devices List

This widget displays a list of active devices. It can include filters, such as device type or status, to make it more user-friendly.

This documentation explains the structure and functionality of the widget that dynamically loads and displays a list of active devices in a table format, with support for dynamic columns and data loading from an API. The widget also includes scrollable functionality for both horizontal and vertical overflow.

---

#### **1. Overview**

This widget displays data in a responsive table format. The table columns are dynamically created based on the `columnDefs` array, which defines the headers and corresponding data fields. The widget uses data fetched from an API (in this case, a service that returns device information) and handles scrolling, dynamic table generation, and updates based on the fetched data.

---

#### **2. HTML Structure**

```html
<div class="overflow-x-auto max-w-full overflow-y-auto p-4 bg-gray-100 rounded-lg shadow-lg max-h-full">
  <table mat-table *ngIf="dataSource" [dataSource]="dataSource" class="min-w-full bg-white rounded-lg shadow-lg">
    <!-- Dynamic Column Definitions -->
    <ng-container *ngFor="let col of columnDefs" [matColumnDef]="col.field">
      <th mat-header-cell *matHeaderCellDef class="text-left px-4 py-2 bg-gray-200 font-semibold text-gray-600 border-b"> 
        {{ col.header }} 
      </th>
      <td mat-cell *matCellDef="let element" class="px-4 py-2 border-b text-gray-700"> 
        {{ element[col.field] }} 
      </td>
    </ng-container>

    <!-- Header and Row Definitions -->
    <tr mat-header-row *matHeaderRowDef="displayedColumns" class="bg-gray-300"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns;" 
        class="hover:bg-gray-100 transition duration-200 ease-in-out cursor-pointer">
    </tr>
  </table>

  <!-- No Data Message -->
  <div *ngIf="!dataSource?.length" class="text-center py-4 text-gray-500">
    No data available
  </div>
</div>
```

**Explanation:**
- **Container (`div`)**: The outer `div` is responsible for enabling horizontal and vertical scrolling. The `max-h-full` ensures that the container will be scrollable when the content exceeds the available height.
- **Table (`mat-table`)**: This table is the core of the widget, which dynamically displays data based on the `dataSource`. The table utilizes Angular Material's table structure for the header and rows.
- **Dynamic Column Definitions (`ng-container`)**: Each column is created dynamically from the `columnDefs` array. The `matColumnDef` directive defines the field for each column, which corresponds to the data property.
- **No Data Message**: If no data is available, the message "No data available" is displayed.

---

#### **3. JavaScript/TypeScript Code**

```javascript
self.onInit = function() {
    const $scope = self.ctx.$scope;

    // Define columnDefs dynamically
    $scope.columnDefs = [
        { field: 'name', header: 'Name' },
        { field: 'label', header: 'Label' },
        { field: 'active', header: 'Active' },
        { field: 'type', header: 'Type' }
    ];

    // Populate displayedColumns based on columnDefs
    $scope.displayedColumns = $scope.columnDefs.map(col => col.field);
    
    // Initialize dataSource
    $scope.dataSource = [];

    // Fetch and transform data
    self.ctx.deviceService.getTenantDeviceInfos({ toQuery: function() { return "?pageSize=500&page=0"; } }).subscribe(res => {
        
        console.log(res.data);

        // Transform data to match the column definitions
        $scope.dataSource = res.data.map(el => ({
            name: el.name,
            label: el.label,
            active: el.active,
            type: el.type
        }));

        console.log($scope.dataSource);

        // Trigger change detection to update the view
        self.ctx.detectChanges();
    });
};
```

**Explanation:**
1. **Column Definitions (`columnDefs`)**: 
   - The columns are defined dynamically in the `columnDefs` array. Each column has a `field` (the data key) and a `header` (the label shown in the table header).
   
2. **Display Columns (`displayedColumns`)**:
   - This array is generated by mapping over `columnDefs` to extract the `field` property for each column. This is passed to the table to determine which columns should be shown.

3. **Data Source Initialization (`dataSource`)**:
   - `dataSource` is initially set as an empty array. It is populated once the data is fetched from the API.

4. **Fetching Data (`getTenantDeviceInfos`)**:
   - The API request is made to fetch device data. The response is then mapped to match the table's structure by extracting the required fields (`name`, `label`, `active`, `type`) from each device.

5. **Change Detection (`detectChanges`)**:
   - Once the data is fetched and transformed, `detectChanges` is called to update the widget view and display the data in the table.



#### **4. How to Customize**

- **Adding More Columns**: To add additional columns, simply extend the `columnDefs` array with more field-header pairs. Ensure the data returned from the API includes the corresponding fields.
- **Styling**: The table and container are styled with Tailwind CSS. You can easily change the design by modifying or adding Tailwind classes.
- **Fetching Data**: The `getTenantDeviceInfos` API call can be modified to fetch data from a different source or with different query parameters. Make sure the response data matches the table's expected format.

---

### **5. Conclusion**

This widget is fully dynamic, responsive, and configurable to display a list of active devices with the ability to adjust columns and data based on the API response. The use of Angular Material components and Tailwind CSS allows for a clean and functional UI that adapts to different screen sizes with a focus on smooth user interaction.